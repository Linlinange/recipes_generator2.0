📋 批量本地化功能完整需求文档
1. 核心目标
    为配方生成器添加批量本地化能力，实现：
    键名：英文（保持游戏内部标识符）
    值：中文（自动生成）
    模板驱动：通过模板 + 材料配置批量生成
    多格式支持：不限于 JSON 模板

2. 功能需求
    2.1 模板系统
        模板文件：包含占位符的通用条目
        {
        "block.pfm.{material_id}_chair": "基本{material_zh_cn}椅子"
        }
        占位符支持：{material_id}, {material_zh_cn}, {modid_safe}, {category}
        多格式加载：.json, .txt, .yaml（未来扩展）
        职责分离：Template 只负责加载字符串，Engine 负责解析
    2.2 材料配置（BatchItem）
        材料定义：
        {
        "id": "minecraft:oak",
        "zh_cn": "橡木",
        "namespace": "minecraft:",
        "replacements": {"原木": "", "木": ""}
        }
        特殊转换：
        菌类：原木 → 菌柄
        石材：删除所有"木"相关词
        跳过模式：skip_patterns: ["stripped"]
        分类：category: "material" | "tool" | "food" | ...
    2.3 生成引擎（LocalizationEngine）
        职责：
        加载并解析模板（JSON → dict）
        遍历 BatchItem
        替换占位符
        应用材料专属替换
        键名特殊处理（log→stem, 清理下划线）
        错误捕获与继续
        输出：
        Python
        复制
        {
        "minecraft:oak": {
            "block.pfm.oak_chair": "基本橡木椅子",
            "block.pfm.oak_table": "橡木桌子"
        }
        }
    2.4 数据访问层（DAO）
        BatchItemDAO：加载/保存材料配置
        ConfigDAO：加载/保存主配置
        TemplateLoader：模板文件加载
        OutputWriter：结果写入

3. 非功能需求
    3.1 架构设计
        分层架构：model / dao / core / io
        职责单一：每个类只做一件事
        可扩展性：支持未来 tool/food 类别
        类型安全：使用 dataclass 和类型注解
    3.2 健壮性
        防御性编程：
        should_skip_template() 处理 None 和非法类型
        generate_batch() 捕获所有异常并继续
        输入验证：DAO 层验证必需字段
        错误消息：清晰、可操作的异常信息
    3.3 测试覆盖
        单元测试：每个 public 方法都有测试
        边界情况：空值、None、非法类型、跨平台
        集成测试：完整生成流程
        Mock 测试：模拟 IO 异常

4. 已知问题与约定
    4.1 模板设计规范
        空命名空间后不应有下划线：{modid_safe}{material_id} ✅
        避免：{modid_safe}_{material_id} ❌（空命名空间时会产生 _oak）
    4.2 特殊约定
        菌类材料：log → stem
        非木质：skip_patterns: ["stripped"] 跳过所有去皮条目
        元数据键：以 _ 开头，不参与替换